[env:esp32dev]
platform = espressif32
board = esp32dev
framework = arduino
monitor_speed = 115200
board_build.filesystem = spiffs

# Use default partition scheme - should work with ElegantOTA
# board_build.partitions = default.csv

lib_deps =
  https://github.com/ayushsharma82/ElegantOTA.git
  https://github.com/me-no-dev/ESPAsyncWebServer.git
  https://github.com/me-no-dev/AsyncTCP.git
  adafruit/DHT sensor library@^1.4.6
  bblanchon/ArduinoJson@^6.21.5
  https://github.com/tzapu/WiFiManager.git
  arduino-libraries/NTPClient @ ^3.2.1

# Optimization flags to reduce code size
build_flags=
  -DELEGANTOTA_USE_ASYNC_WEBSERVER=1
  -Os                    # Optimize for size
  -DCORE_DEBUG_LEVEL=0   # Disable debug output
  -DARDUINO_LOOP_STACK_SIZE=8192  # Reduce loop stack size
  -ffunction-sections    # Enable dead code elimination
  -fdata-sections        # Enable dead data elimination
  -Wl,--gc-sections      # Garbage collect unused sections
  ;-DBOARD_HAS_PSRAM=0    # Disable PSRAM to save space